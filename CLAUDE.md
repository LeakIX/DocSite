# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with
code in this repository.

## Project Overview

This is the documentation site for LeakIX, a red-team search engine indexing
mis-configurations and vulnerabilities online. The site is built with Hugo
v0.151.0+ (requires Go 1.24+) using the Compose theme and is hosted on GitHub
Pages at https://docs.leakix.net/.

## Architecture

**Hugo Module System**: The project uses Hugo modules (not traditional themes)
to load the Compose theme from `github.com/onweru/compose`. The theme is defined
in `go.mod` as a dependency and loaded via Hugo's module system.

**Content Structure**:

- `content/docs/` - Main documentation organized into three sections:
  - `query/` - Query syntax, fields, and dorks for searching LeakIX
  - `api/` - API endpoints, authentication, and data formats (L9 format)
  - `user/` - User features like alerting and resources
- `content/tutorials/` - Tutorial content (separate from docs)
- `content/_index.md` - Homepage with custom layout using Hugo shortcodes

**Configuration**:

- `config.toml` - Base configuration with theme, baseURL, and output formats
- `config/_default/params.toml` - Site-specific parameters including:
  - `docSections` array defines searchable documentation sections
  - Search configuration (site-specific, not global)
  - Logo paths for light/dark modes
  - Line number and code display settings

**Build & Deploy**: Automated via GitHub Actions (`.github/workflows/hugo.yml`):

- Builds use Hugo extended version with garbage collection and minification
- Requires Dart Sass for SCSS compilation
- Deploys to GitHub Pages on push to master branch
- Output directory is `public/`

**Code Formatting**:

- Prettier is configured with `prettier-plugin-go-template` for Hugo template
  support
- Configuration in `.prettierrc.json` includes:
  - 80 character line width with prose wrapping for markdown
  - Special parser for `.html` files (go-template)
  - SCSS files use double quotes (override)
- **ALWAYS run `make prettify` and `make fix-trailing-whitespace` before
  committing**

## Commands

```bash
make install-deps                  # Install dependencies
make serve                         # Run development server at localhost:1313
make build                         # Build site with optimizations
make build BASEURL=url CACHEDIR=dir  # Build with custom baseURL and cache directory
make prettify                      # Format all files with Prettier
make check-prettify                # Check if files are properly formatted
make fix-trailing-whitespace       # Remove trailing whitespace
make check-trailing-whitespace     # Check for trailing whitespace
make test                          # Run all checks (trailing whitespace + prettify + build)
make clean                         # Clean build artifacts and node_modules
make help                          # Show all available targets
```

## Content Guidelines

- All content pages use frontmatter with `title`, `weight`, and optional
  `description`
- The site uses custom Hugo shortcodes extensively (e.g., `{{< button >}}`,
  `{{< tip >}}`, `{{< block "grid-2" >}}`)
- Images are stored in `static/images/`
- Search is enabled but limited to specific sections defined in `docSections`
  parameter

## Important Rules

- **NEVER mention Claude or AI assistance** in commit messages, code comments,
  documentation, or any files in this repository
- Do not add attribution like "Generated by Claude" or "Co-Authored-By: Claude"
  to commits
- All work should appear as if written directly by the human developer
